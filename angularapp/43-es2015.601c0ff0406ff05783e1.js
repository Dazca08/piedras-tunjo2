(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{Fv63:function(r,e,o){"use strict";o.r(e);var t=o("ofXK"),i=o("mrSG"),n=o("fXoL"),a=o("VngK"),c=o("vDOo"),s=o("tyNb"),d=o("4ZJM"),l=o("AytR"),u=o("PSD3"),m=o.n(u);const p=["mapa"];let b=(()=>{class r{constructor(r,e){this.geometryService=r,this.recorridosService=e,this.eliminado=new n.q,this.geojson={type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"LineString",coordinates:[]}}]}}ngOnInit(){}ngAfterViewInit(){d.accessToken=l.a.mapboxToken,this.mapbox=new d.Map({container:this.mapa.nativeElement,style:"mapbox://styles/mapbox/streets-v11",center:[-74.3451602,4.8154681],zoom:14.5}),this.mapbox.on("load",()=>{this.mapbox.addSource("line",{type:"geojson",data:this.geojson}),this.mapbox.addLayer({id:"line-animation",type:"line",source:"line",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#ed6498","line-width":5,"line-opacity":.8}}),this.cargarRuta(),this.cargarPtsControl(),this.cargarPtsInteres()}),this.mapbox.addControl(new d.NavigationControl),this.mapbox.addControl(new d.FullscreenControl)}cargarRuta(){const r=this.geometryService.getCoordinates(this.recorrido.RutaText);this.geojson.features[0].geometry.coordinates=r,this.mapbox.getSource("line").setData(this.geojson)}cargarPtsControl(){JSON.parse(this.recorrido.PuntosControl).forEach(r=>{const e=new d.Popup({offset:25}).setText(r.nombre);new d.Marker({color:"#d33"}).setPopup(e).setLngLat([r.longitud,r.latitud]).addTo(this.mapbox)})}cargarPtsInteres(){JSON.parse(this.recorrido.PuntosInteres).forEach(r=>{const e=new d.Popup({offset:25}).setText(r.Descripcion);(new d.Marker).setPopup(e).setLngLat([r.Longitud,r.Latitud]).addTo(this.mapbox)})}eliminar(){m.a.fire({title:"\xbfEst\xe1s seguro?",text:"No ser\xe1s capaz de revertir los cambios",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, eliminar",cancelButtonText:"Cancelar"}).then(r=>Object(i.a)(this,void 0,void 0,(function*(){r.value&&(yield this.recorridosService.eliminarRecorrido(this.recorrido.Id))&&(m.a.fire("Eliminado!","success"),this.eliminado.emit(this.recorrido.Id))})))}}return r.\u0275fac=function(e){return new(e||r)(n.Vb(c.a),n.Vb(a.a))},r.\u0275cmp=n.Pb({type:r,selectors:[["app-card-recorrido"]],viewQuery:function(r,e){var o;1&r&&n.Hc(p,!0),2&r&&n.wc(o=n.jc())&&(e.mapa=o.first)},inputs:{recorrido:"recorrido"},outputs:{eliminado:"eliminado"},decls:13,vars:2,consts:[[1,"card","shadow"],[1,"card-header"],[1,"text-muted"],[1,"float-right"],[1,"btn","btn-sm","btn-outline-danger",3,"click"],[1,"fas","fa-trash"],[1,"card-body"],["id","map"],["mapa",""]],template:function(r,e){1&r&&(n.ac(0,"div",0),n.ac(1,"div",1),n.ac(2,"b",2),n.Dc(3),n.Zb(),n.Wb(4,"br"),n.ac(5,"small"),n.Dc(6),n.Zb(),n.ac(7,"div",3),n.ac(8,"div",4),n.ic("click",(function(){return e.eliminar()})),n.Wb(9,"i",5),n.Zb(),n.Zb(),n.Zb(),n.ac(10,"div",6),n.Wb(11,"div",7,8),n.Zb(),n.Zb()),2&r&&(n.Jb(3),n.Ec(e.recorrido.Nombre),n.Jb(3),n.Fc("",e.recorrido.TiempoEstimado," minutos aprox."))},styles:["#map[_ngcontent-%COMP%]{width:100%;height:250px}"]}),r})();function h(r,e){1&r&&(n.ac(0,"div",8),n.ac(1,"h5",9),n.Dc(2,"No hay rutas para mostrar"),n.Zb(),n.Zb())}function g(r,e){if(1&r){const r=n.bc();n.ac(0,"app-card-recorrido",10),n.ic("eliminado",(function(e){return n.yc(r),n.kc().eliminar(e)})),n.Zb()}2&r&&n.rc("recorrido",e.$implicit)}let f=(()=>{class r{constructor(r,e){this.recorridosService=r,this.geometryService=e,this.recorridos=[]}ngOnInit(){this.cargarRecorridos()}cargarRecorridos(){return Object(i.a)(this,void 0,void 0,(function*(){this.recorridos=yield this.recorridosService.getRecorridos()}))}eliminar(r){this.recorridos=this.recorridos.filter(e=>e.Id!==r)}}return r.\u0275fac=function(e){return new(e||r)(n.Vb(a.a),n.Vb(c.a))},r.\u0275cmp=n.Pb({type:r,selectors:[["app-inicio"]],decls:12,vars:2,consts:[[1,"container","p-2"],["routerLink","/recorridos/nuevo",1,"btn","btn-sm","btn-success"],[1,"float-right"],[1,"badge","badge-primary","mr-2"],[1,"badge","badge-danger"],["class","container",4,"ngIf"],[1,"row"],["class","col-md-4 col-sm-6 mb-2",3,"recorrido","eliminado",4,"ngFor","ngForOf"],[1,"container"],[1,"text-muted"],[1,"col-md-4","col-sm-6","mb-2",3,"recorrido","eliminado"]],template:function(r,e){1&r&&(n.ac(0,"div",0),n.ac(1,"button",1),n.Dc(2,"Nueva ruta"),n.Zb(),n.ac(3,"div",2),n.ac(4,"span",3),n.Dc(5,"Punto de inter\xe9s"),n.Zb(),n.ac(6,"span",4),n.Dc(7,"Punto de control"),n.Zb(),n.Zb(),n.Zb(),n.Wb(8,"hr"),n.Bc(9,h,3,0,"div",5),n.ac(10,"div",6),n.Bc(11,g,1,1,"app-card-recorrido",7),n.Zb()),2&r&&(n.Jb(9),n.rc("ngIf",0===e.recorridos.length),n.Jb(2),n.rc("ngForOf",e.recorridos))},directives:[s.c,t.m,t.l,b],styles:[""]}),r})();var v=o("j1ZV"),y=o("3Pt+");o.d(e,"InicioModule",(function(){return w}));let w=(()=>{class r{}return r.\u0275mod=n.Tb({type:r}),r.\u0275inj=n.Sb({factory:function(e){return new(e||r)},imports:[[t.b,v.a,y.e,s.e.forChild([{path:"",component:f}])]]}),r})()}}]);