(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{"1e+B":function(i,o,e){"use strict";e.r(o);var t=e("ofXK"),n=e("tyNb"),r=e("PSD3"),a=e.n(r),c=e("fXoL"),s=e("OI+n"),h=e("3Pt+"),l=e("oOf3");let b=(()=>{class i{transform(i,o){if(""===o||o.length<3)return i;const e=[];for(const t of i)t.Nombre.toLowerCase().indexOf(o.toLowerCase())>-1&&e.push(t);return console.log(e),e}}return i.\u0275fac=function(o){return new(o||i)},i.\u0275pipe=c.Sb({name:"filtroprom",type:i,pure:!0}),i})();function m(i,o){1&i&&(c.Yb(0,"div"),c.Ub(1,"hr"),c.Yb(2,"div"),c.Yb(3,"h6"),c.Ac(4,"Lo sentimos en este momento no existen Promociones "),c.Xb(),c.Xb(),c.Xb())}function d(i,o){if(1&i){const i=c.Zb();c.Yb(0,"div",21),c.Yb(1,"div",22),c.Yb(2,"div",23),c.Yb(3,"h5"),c.Ub(4,"i",24),c.Ac(5),c.Xb(),c.Xb(),c.Yb(6,"div",25),c.Yb(7,"form",26,27),c.gc("ngSubmit",(function(){c.vc(i);const o=c.uc(8);return c.ic(2).guardar(o)})),c.Yb(9,"p",28),c.Ub(10,"i",29),c.Ac(11," Nombre promocion "),c.Xb(),c.Yb(12,"input",30,31),c.gc("ngModelChange",(function(e){return c.vc(i),o.$implicit.Nombre=e})),c.Xb(),c.Ub(14,"hr"),c.Yb(15,"p",28),c.Ub(16,"i",29),c.Ac(17," Descripcion "),c.Xb(),c.Yb(18,"div",4),c.Yb(19,"textarea",32),c.gc("ngModelChange",(function(e){return c.vc(i),o.$implicit.Descripcion=e})),c.Xb(),c.Xb(),c.Yb(20,"input",33,34),c.gc("ngModelChange",(function(e){return c.vc(i),o.$implicit.Descripcion=e})),c.Xb(),c.Yb(22,"input",35,36),c.gc("ngModelChange",(function(e){return c.vc(i),o.$implicit.Id=e})),c.Xb(),c.Yb(24,"input",37,38),c.gc("ngModelChange",(function(e){return c.vc(i),o.$implicit.LastModification=e})),c.Xb(),c.Ub(26,"hr"),c.Yb(27,"div",2),c.Yb(28,"div",39),c.Yb(29,"p",28),c.Ub(30,"i",40),c.Ac(31," Inicio de promocion "),c.Xb(),c.Yb(32,"input",41,42),c.gc("ngModelChange",(function(e){return c.vc(i),o.$implicit.FechaInicio=e})),c.Xb(),c.Xb(),c.Yb(34,"div",39),c.Yb(35,"p",28),c.Ub(36,"i",40),c.Ac(37," Final de promocion "),c.Xb(),c.Yb(38,"input",43,44),c.gc("ngModelChange",(function(e){return c.vc(i),o.$implicit.FechaFin=e})),c.Xb(),c.Xb(),c.Xb(),c.Ub(40,"hr"),c.Yb(41,"div",2),c.Yb(42,"div",39),c.Yb(43,"p",28),c.Ub(44,"i",45),c.Ac(45," Estado "),c.Xb(),c.Yb(46,"select",46,47),c.gc("ngModelChange",(function(e){return c.vc(i),o.$implicit.Estado=e})),c.Yb(48,"option",48),c.Ac(49,"1"),c.Xb(),c.Yb(50,"option"),c.Ac(51,"2"),c.Xb(),c.Xb(),c.Xb(),c.Yb(52,"div",39),c.Yb(53,"p",28),c.Ub(54,"i",49),c.Ac(55," Descuento "),c.Xb(),c.Yb(56,"select",50,51),c.gc("ngModelChange",(function(e){return c.vc(i),o.$implicit.PorcentajeDescuento=e})),c.Yb(58,"option",48),c.Ac(59,"10"),c.Xb(),c.Yb(60,"option"),c.Ac(61,"20"),c.Xb(),c.Yb(62,"option"),c.Ac(63,"30"),c.Xb(),c.Yb(64,"option"),c.Ac(65,"40"),c.Xb(),c.Yb(66,"option"),c.Ac(67,"50"),c.Xb(),c.Yb(68,"option"),c.Ac(69,"60"),c.Xb(),c.Yb(70,"option"),c.Ac(71,"70"),c.Xb(),c.Xb(),c.Xb(),c.Xb(),c.Ub(72,"hr"),c.Ub(73,"div",2),c.Yb(74,"input",52,53),c.gc("ngModelChange",(function(e){return c.vc(i),o.$implicit.Token=e})),c.Xb(),c.Ub(76,"br"),c.Yb(77,"div",2),c.Yb(78,"div",39),c.Yb(79,"div",4),c.Yb(80,"form",12),c.gc("submit",(function(){c.vc(i);const e=o.$implicit;return c.ic(2).eliminar(e.Id)})),c.Yb(81,"button",54),c.Ub(82,"i",55),c.Ac(83," Eliminar "),c.Xb(),c.Xb(),c.Xb(),c.Xb(),c.Yb(84,"div",39),c.Yb(85,"div",4),c.Yb(86,"button",56),c.Ub(87,"i",57),c.Ac(88," Editar "),c.Xb(),c.Xb(),c.Xb(),c.Xb(),c.Xb(),c.Xb(),c.Xb(),c.Xb()}if(2&i){const i=o.$implicit;c.Hb(5),c.Cc(" Promocion: ",i.Nombre,""),c.Hb(7),c.nc("ngModel",i.Nombre),c.Hb(7),c.nc("ngModel",i.Descripcion),c.Hb(1),c.nc("ngModel",i.Descripcion),c.Hb(2),c.nc("ngModel",i.Id),c.Hb(2),c.nc("ngModel",i.LastModification),c.Hb(8),c.nc("ngModel",i.FechaInicio),c.Hb(6),c.nc("ngModel",i.FechaFin),c.Hb(8),c.nc("ngModel",i.Estado),c.Hb(10),c.nc("ngModel",i.PorcentajeDescuento),c.Hb(18),c.nc("ngModel",i.Token)}}const p=function(i){return{itemsPerPage:2,currentPage:i}};function g(i,o){if(1&i){const i=c.Zb();c.Yb(0,"div"),c.Yb(1,"section",15),c.Yb(2,"div",1),c.Yb(3,"div",16),c.Yb(4,"div",17),c.yc(5,d,89,11,"div",18),c.jc(6,"paginate"),c.jc(7,"filtroprom"),c.Xb(),c.Yb(8,"div",19),c.Yb(9,"pagination-controls",20),c.gc("pageChange",(function(o){return c.vc(i),c.ic().PageActual=o})),c.Xb(),c.Xb(),c.Xb(),c.Xb(),c.Xb(),c.Xb()}if(2&i){const i=c.ic();c.Hb(5),c.nc("ngForOf",c.lc(6,1,c.lc(7,4,i.promo,i.filtropromPost),c.rc(7,p,i.PageActual)))}}function f(i,o){1&i&&(c.Yb(0,"div"),c.Yb(1,"div",4),c.Yb(2,"div",1),c.Yb(3,"div",58),c.Yb(4,"h4"),c.Ac(5,"Calendario de Promociones"),c.Xb(),c.Ub(6,"hr"),c.Ub(7,"div",59),c.Xb(),c.Xb(),c.Xb(),c.Xb())}let u=(()=>{class i{constructor(i,o){this.ServiciopromService=i,this.router=o,this.filtropromPost="",this.fechatemp="",this.fechartemp="",this.PageActual=1,this.indicador=!0,this.indicadorBoton="Ver calendario de promociones",this.icono="calendar",this.fechatempi1="",this.fechatempF1="",this.fechatempi2="",this.fechatempF2="",this.nombretemp="",this.contador=0,this.contador2=0,this.arraiy=[{title:"",start:"",end:"",color:""}],this.temp=[{title:"",start:"",end:"",color:""}],this.arraitemp=[{title:"",start:"",end:"",color:""}],this.array={title:"",start:"",end:"",color:""}}clean(){this.temp=[{title:"",start:"",end:"",color:""}]}ObtenerPromocion(){1==this.indicador?this.ServiciopromService.Obtenerpromocion().subscribe(i=>{for(this.promo=i,console.log(this.promo),this.i=0;this.i<this.promo.length;this.i++){this.fechatemp=this.promo[this.i].FechaInicio,this.fechartemp=this.promo[this.i].FechaFin;var o=this.fechatemp.split("T",2),e=this.fechartemp.split("T",2);this.fechatemp=o[0],this.fechartemp=e[0],this.promo[this.i].FechaInicio=this.fechatemp,this.promo[this.i].FechaFin=this.fechartemp}console.log(this.promo)},i=>{console.log(JSON.stringify(i))}):0==this.indicador&&(this.contador++,console.log(this.contador),this.ServiciopromService.Obtenerpromocion().subscribe(i=>{for(this.promo=i,this.contador>1&&(this.clean(),console.log(this.temp),console.log(this.arraiy),this.arraiy=this.temp),this.promo=this.promo.filter(i=>"1"==i.Estado),this.i=0;this.i<this.promo.length;this.i++){this.fechatemp=this.promo[this.i].FechaInicio,this.fechartemp=this.promo[this.i].FechaFin;var o=this.fechatemp.split("T",2),e=this.fechartemp.split("T",2);this.fechatemp=o[0],this.fechartemp=e[0],this.promo[this.i].FechaInicio=this.fechatemp,this.promo[this.i].FechaFin=this.fechartemp,this.nombretemp=this.promo[this.i].Nombre,console.log(this.temp),console.log(this.arraiy),this.arraiy=this.temp,this.arraiy.push({title:this.nombretemp,start:this.fechatemp,end:this.fechartemp,color:this.coloresAleatorios()})}console.log(this.promo),this.funcion(this.arraiy,this.promo)},i=>{console.log(JSON.stringify(i))}))}eliminar(i){a.a.fire({title:"Estas seguro?",text:" No se podra recuperar la informacion!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, Borrar!"}).then(o=>{o.value&&(a.a.fire("Borrado!"," la informacion ha sido eliminada","success"),this.ServiciopromService.Eliminar(i),setTimeout(()=>{this.refrescar()},2e3))})}listarContestados(){1==this.indicador?(this.ngOnInit(),this.indicador=!1,this.indicadorBoton="Inicio",this.icono="home"):0==this.indicador&&(this.ngOnInit(),this.indicador=!0,this.indicadorBoton="Ver calendario de promociones",this.icono="calendar"),this.ngOnInit()}coloresAleatorios(){var i,o,e=["#000099","#00FFCC","#6699CC","#CC6600","#33CC00","#66CC99","#990099","#99FF00"],t="",n=[];for(i=0;i<e.length;i++)n[i]=i;for(i=0;i<4;i++)t=e[n[o=Math.floor(Math.random()*n.length)]],n.splice(o,1);return console.log(t),t}refrescar(){for(this.i=0;this.i<1;this.i++)this.ObtenerPromocion()}guardar({value:i}){console.log(i),""==i.Nombre||""==i.Descripcion?a.a.fire("Por favor llene todos los campos!","pregunta no editada!","error"):i.Nombre.length<5||i.Descripcion.length<10?a.a.fire("el nombre de la promocion debe tener al menos 5 caracteres y la descripcion al menos 10!","pregunta no editada!","error"):a.a.fire({title:"Esta seguro?",text:"Desea editar esta promocion?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, guardar!"}).then(o=>{o.value&&(console.log(i),this.comparacion(i),setTimeout(()=>{this.refrescar()},2e3))})}funcion(i,o){console.log(i),console.log("Con repetidos es:",i);let e=i.filter((i,o,e)=>e.findIndex(o=>JSON.stringify(o.start)===JSON.stringify(i.start))===o);console.log("Sin repetidos es:",e),console.log(e.length),$("#calendar").fullCalendar({header:{left:"prev,next today",center:"title",right:"month,agendaWeek,agendaDay"},locale:"es",monthNames:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],monthNamesShort:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],dayNames:["Domingo","Lunes","Martes","Mi\xe9rcoles","Jueves","Viernes","S\xe1bado"],dayNamesShort:["Dom","Lun","Mar","Mi\xe9","Jue","Vie","S\xe1b"],navLinks:!0,editable:!0,eventLimit:!0,events:e,eventClick:function(o){a.a.fire({title:"Espere por favor",text:"Cargando informaci\xf3n",icon:"info",allowOutsideClick:!1}),a.a.showLoading(),this.nombretemmp=o.title,this.filtronombre=i.filter(i=>i.title==this.nombretemmp),0==this.filtronombre.length?a.a.fire("No existen eventos en este dia !","consulte los dias marcados con un evento para mas informacion","info"):(this.filtronombre=i.filter(i=>i.title==this.nombretemmp),this.array=this.filtronombre[0],a.a.fire(this.array.title==this.nombretemmp?{title:this.array.title,text:"esta promocion va desde: "+this.array.start+", hasta : "+this.array.end,icon:"info"}:{title:"lo sentimos ",text:"no hay eventos",imageUrl:"http://piedrasdeltunjo.tk/images/getImage?tipo=evento&nombre="+this.evento.ImagenesUrl,imageWidth:400,imageHeight:200,imageAlt:"Custom image"}))}})}splitfecha(i){return i.split("-")}splitfechaT(i){return i.toString().split("T")[0]}parseo(i){return{"a\xf1o":parseInt(i[0],10),mes:parseInt(i[1],10),dia:parseInt(i[2],10)}}Comparacionfecha(i,o,e,t){var n=this.parseo(i);console.log(n);var r=this.parseo(o);console.log(r);var a=this.parseo(e);console.log(a);var c,s=this.parseo(t);return console.log(s),c=n.mes==a.mes&&n.mes==s.mes&&n.dia>=a.dia&&n.dia<=s.dia?"invalida":r.mes==a.mes&&r.mes==s.mes&&r.dia>=a.dia&&r.dia<=s.dia?"invalida":r.mes>=s.mes&&n.mes<s.mes&&r.dia>s.dia?"invalida":r.mes>=s.mes&&n.mes==s.mes&&n.dia<s.dia&&r.dia>s.dia?"invalida":"valida",console.log(c),c}comparacion(i){var o="no existe";this.ServiciopromService.Obtenerpromocion().subscribe(e=>{this.promotemp=e;var t="",n="";for(this.i=0;this.i<this.promotemp.length;this.i++)i.Id!=this.promotemp[this.i].Id&&(t=this.splitfechaT(this.promotemp[this.i].FechaInicio),n=this.splitfechaT(this.promotemp[this.i].FechaFin),this.fechatempi1=this.splitfecha(i.FechaInicio),this.fechatempF1=this.splitfecha(i.FechaFin),this.fechatempi2=this.splitfecha(t),this.fechatempF2=this.splitfecha(n),this.resultadoComparacion=this.Comparacionfecha(this.fechatempi1,this.fechatempF1,this.fechatempi2,this.fechatempF2),console.log(this.resultadoComparacion),"invalida"==this.resultadoComparacion&&(o="existe"));"existe"==o?(a.a.fire("La nueva fecha es incorrecta ya que en ese rango exite una promocion","Promocion no actualizada","error"),this.refrescar()):this.ServiciopromService.update(i)})}ngOnInit(){this.ObtenerPromocion()}}return i.\u0275fac=function(o){return new(o||i)(c.Tb(s.a),c.Tb(n.b))},i.\u0275cmp=c.Nb({type:i,selectors:[["app-inicioprom"]],decls:32,vars:9,consts:[["id","main-header",1,"py-2","bg-info","text-white"],[1,"container"],[1,"row"],[1,"col-md-4"],["align","center"],[1,"form-group"],["type","text","name","filtropromPost","placeholder","Buscar promocion por nombre....",1,"form-control",3,"ngModel","ngModelChange"],[1,"fas","fa-list-ol"],[1,"display-4"],[1,"col-md-3"],["href","promociones/agregar","role","button",1,"btn","btn-info"],[1,"fas","fa-plus"],[3,"submit"],["type","submit",1,"btn","btn-info"],[4,"ngIf"],["id","promociones"],[1,"col-md-15"],[1,"row","row-cols-1","row-cols-md-2"],["class","col mb-5",4,"ngFor","ngForOf"],[1,"text-center"],[3,"pageChange"],[1,"col","mb-5"],[1,"card","h-100"],[1,"card-header"],[1,"fa","fa-piggy-bank"],[1,"car-body","container"],[3,"ngSubmit"],["promocionForm","ngForm"],[1,"card-text"],[1,"fa","fa-pencil-alt"],["type","text","name","Nombre",1,"form-control",3,"ngModel","ngModelChange"],["nombre","ngModel"],["name","Descripcion","rows","2","cols","65",3,"ngModel","ngModelChange"],["type","hidden","name","Descripcion",1,"form-control",3,"ngModel","ngModelChange"],["Descripcion","ngModel"],["type","hidden","name","Id",1,"form-control",3,"ngModel","ngModelChange"],["id","ngModel"],["type","hidden","name","LastModification",1,"form-control",3,"ngModel","ngModelChange"],["LastModification","ngModel"],[1,"col-md-6"],[1,"fa","fa-calendar"],["type","date","name","FechaInicio",1,"form-control",3,"ngModel","ngModelChange"],["FechaInicio","ngModel"],["type","date","name","FechaFin",1,"form-control",3,"ngModel","ngModelChange"],["FechaFin","ngModel"],[1,"fa","fa-eye-slash"],["name","Estado",1,"form-control",3,"ngModel","ngModelChange"],["Estado","ngModel"],["selected",""],[1,"fa","fa-percent"],["name","PorcentajeDescuento",1,"form-control",3,"ngModel","ngModelChange"],["PorcentajeDescuento","ngModel"],["type","hidden","name","Token",1,"form-control",3,"ngModel","ngModelChange"],["Token","ngModel"],["type","submit",1,"btn","btn-danger","btn-block",2,"width","130"],[1,"fas","fa-trash"],["type","submit",1,"btn","btn-primary","btn-block",2,"width","130"],[1,"fas","fa-edit"],[1,"col-md-9"],["id","calendar",2,"background","white"]],template:function(i,o){1&i&&(c.Yb(0,"header",0),c.Yb(1,"div",1),c.Yb(2,"div",2),c.Yb(3,"div",3),c.Yb(4,"div",4),c.Yb(5,"h1"),c.Ac(6," Promociones "),c.Xb(),c.Yb(7,"div",5),c.Yb(8,"input",6),c.gc("ngModelChange",(function(i){return o.filtropromPost=i})),c.Xb(),c.Xb(),c.Xb(),c.Xb(),c.Yb(9,"div",3),c.Yb(10,"div",4),c.Yb(11,"h3"),c.Ub(12,"i",7),c.Ac(13," Total Promociones"),c.Xb(),c.Yb(14,"h4",8),c.Ac(15),c.Xb(),c.Xb(),c.Xb(),c.Yb(16,"div",9),c.Yb(17,"div",4),c.Ub(18,"br"),c.Yb(19,"a",10),c.Yb(20,"h6"),c.Ub(21,"i",11),c.Ac(22," Nueva Promocion"),c.Xb(),c.Xb(),c.Yb(23,"form",12),c.gc("submit",(function(){return o.listarContestados()})),c.Yb(24,"button",13),c.Yb(25,"h6"),c.Ub(26,"i"),c.Ac(27),c.Xb(),c.Xb(),c.Xb(),c.Xb(),c.Xb(),c.Xb(),c.Xb(),c.Xb(),c.Ub(28,"br"),c.yc(29,m,5,0,"div",14),c.yc(30,g,10,9,"div",14),c.yc(31,f,8,0,"div",14)),2&i&&(c.Hb(8),c.nc("ngModel",o.filtropromPost),c.Hb(7),c.Cc(" ",null==o.promo?null:o.promo.length," "),c.Hb(11),c.Kb("fas fa-",o.icono,""),c.Hb(1),c.Cc(" ",o.indicadorBoton,""),c.Hb(2),c.nc("ngIf",0==o.promo.length),c.Hb(1),c.nc("ngIf",1==o.indicador),c.Hb(1),c.nc("ngIf",0==o.indicador))},directives:[h.a,h.g,h.j,h.s,h.h,h.i,t.m,t.l,l.c,h.p,h.k,h.r],pipes:[l.b,b],styles:[""]}),i})();var v=e("iTUp");e.d(o,"IniciopromModule",(function(){return X}));let X=(()=>{class i{}return i.\u0275mod=c.Rb({type:i}),i.\u0275inj=c.Qb({factory:function(o){return new(o||i)},imports:[[t.b,h.e,l.a,v.a,n.e.forChild([{path:"",component:u}])]]}),i})()}}]);