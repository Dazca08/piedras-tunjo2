(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{HnS2:function(e,t,r){"use strict";r.r(t);var a=r("ofXK"),c=r("tyNb"),n=r("mrSG"),s=r("5RHE"),i=r("DaQG"),o=r.n(i),b=r("fXoL"),l=r("tk/3"),h=r("AytR"),d=r("JIr8"),u=r("LRne"),v=r("Ig2y");const p=h.a.apiUrl;let f=(()=>{class e{constructor(e,t,r){this.http=e,this.router=t,this.dateService=r}prepareHeaders(){const e=localStorage.getItem("token")||void 0;return e?(this.headers=new l.c({Authorization:"Bearer "+e}),!0):(this.router.navigateByUrl("/login"),!1)}getReservasTickets(){return this.prepareHeaders()?new Promise(e=>{this.http.get(`${p}/reserva-tickets`,{headers:this.headers}).pipe(Object(d.a)(e=>Object(u.a)({ok:!1}))).subscribe(t=>{e(!0===t.ok?t.reservas:[])})}):(console.log("Token not found"),Promise.resolve([]))}getDataChart(e,t){const r=[];return this.dateService.meses.forEach((a,c)=>{r.push(this.getTicketsByMonthYear(e,c+1,Number(t)))}),r}getTicketsByMonthYear(e,t,r){const a=[];return e.forEach(e=>{const c=e.FechaIngreso.toString().split("T")[0],n=Number(c.split("-")[0]),s=Number(c.split("-")[1]);n===r&&s===t&&a.push(e)}),a.length}}return e.\u0275fac=function(t){return new(t||e)(b.ec(l.a),b.ec(c.b),b.ec(v.a))},e.\u0275prov=b.Rb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var g=r("3Pt+"),k=r("LPYB");function C(e,t){if(1&e&&(b.ac(0,"option",12),b.Cc(1),b.Zb()),2&e){const e=t.index,r=b.kc();b.rc("value",r.years[e]),b.Jb(1),b.Dc(r.years[e])}}let m=(()=>{class e{constructor(e,t){this.reservaTickService=e,this.dateService=t,this.selectedYear=(new Date).getFullYear(),this.years=[],this.typeChart="line",this.barChartOptions={responsive:!0,scales:{xAxes:[{}],yAxes:[{}]},plugins:{datalabels:{anchor:"end",align:"end"}}},this.barChartLabels=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre",""],this.barChartType="line",this.barChartLegend=!0,this.barChartData=[{data:[65,59,80,81,56,55,40,50,40,40,60,40,0],label:"Meses"}]}ngOnInit(){this.years=this.dateService.getYears(),this.prepareData()}prepareData(e=(new Date).getFullYear()){const t=this.reservaTickService.getDataChart(this.reservas,e);this.barChartData[0].data=t}onChange(e){this.prepareData(e.target.value)}chartClicked({event:e,active:t}){console.log(e,t)}chartHovered({event:e,active:t}){console.log(e,t)}}return e.\u0275fac=function(t){return new(t||e)(b.Vb(f),b.Vb(v.a))},e.\u0275cmp=b.Pb({type:e,selectors:[["app-chart-reservas-tickets"]],inputs:{reservas:"reservas"},decls:14,vars:9,consts:[[1,"container","text-center"],["role","group",1,"btn-group"],[1,"btn","btn-sm",3,"ngClass","click"],[1,"fas","fa-chart-area"],[1,"fas","fa-chart-bar"],[1,"float-right"],[1,"text-muted"],[1,"form-control-sm",3,"ngModel","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],[1,"row","justify-content-center","mt-5"],[1,"col-10"],["baseChart","",3,"datasets","labels","options","legend","chartType"],[3,"value"]],template:function(e,t){1&e&&(b.ac(0,"div",0),b.ac(1,"div",1),b.ac(2,"button",2),b.ic("click",(function(){return t.typeChart="line"})),b.Wb(3,"i",3),b.Zb(),b.ac(4,"button",2),b.ic("click",(function(){return t.typeChart="bar"})),b.Wb(5,"i",4),b.Zb(),b.Zb(),b.Zb(),b.ac(6,"div",5),b.ac(7,"b",6),b.Cc(8,"Filtrar por a\xf1o "),b.Zb(),b.ac(9,"select",7),b.ic("ngModelChange",(function(e){return t.selectedYear=e}))("change",(function(e){return t.onChange(e)})),b.Bc(10,C,2,2,"option",8),b.Zb(),b.Zb(),b.ac(11,"div",9),b.ac(12,"div",10),b.Wb(13,"canvas",11),b.Zb(),b.Zb()),2&e&&(b.Jb(2),b.rc("ngClass","line"===t.typeChart?"btn-primary":"btn-outline-primary"),b.Jb(2),b.rc("ngClass","bar"===t.typeChart?"btn-primary":"btn-outline-primary"),b.Jb(5),b.rc("ngModel",t.selectedYear),b.Jb(1),b.rc("ngForOf",t.years),b.Jb(3),b.rc("datasets",t.barChartData)("labels",t.barChartLabels)("options",t.barChartOptions)("legend",t.barChartLegend)("chartType",t.typeChart))},directives:[a.k,g.o,g.g,g.j,a.l,k.a,g.k,g.q],styles:[""]}),e})();var y=r("mEn6"),Z=r("OLLB");function T(e,t){if(1&e){const e=b.bc();b.ac(0,"div",9),b.ac(1,"button",5),b.ic("click",(function(){return b.yc(e),b.kc().generarPdft()})),b.Cc(2," Generar Reporte "),b.Zb(),b.Zb()}}function J(e,t){if(1&e&&(b.ac(0,"option",20),b.Cc(1),b.Zb()),2&e){const e=t.index,r=b.kc(2);b.rc("value",r.years[e]),b.Jb(1),b.Dc(r.years[e])}}function M(e,t){if(1&e&&(b.ac(0,"option",20),b.Cc(1),b.Zb()),2&e){const e=t.index,r=b.kc(2);b.rc("value",e+1),b.Jb(1),b.Dc(r.months[e])}}function D(e,t){1&e&&(b.ac(0,"tr",21),b.ac(1,"td",22),b.Cc(2,"No hay reservas para mostrar en el mes seleccionado"),b.Zb(),b.Zb())}function S(e,t){if(1&e&&(b.ac(0,"tr"),b.ac(1,"td"),b.Cc(2),b.lc(3,"date"),b.Zb(),b.ac(4,"td"),b.Cc(5),b.Zb(),b.ac(6,"td"),b.Cc(7),b.lc(8,"currency"),b.Zb(),b.ac(9,"td"),b.Cc(10),b.Zb(),b.ac(11,"td"),b.Cc(12),b.Zb(),b.Zb()),2&e){const e=t.$implicit,r=b.kc(2);b.Jb(2),b.Dc(b.nc(3,5,e.FechaIngreso,"dd MMM yyyy")),b.Jb(3),b.Dc(e.Cantidad),b.Jb(2),b.Dc(b.nc(8,8,e.Precio,"COP ")),b.Jb(3),b.Dc(e.NumeroDocumento),b.Jb(2),b.Dc(r.nameTicket(e.idTicket))}}function I(e,t){if(1&e){const e=b.bc();b.ac(0,"div",10),b.ac(1,"div",11),b.ac(2,"div",12),b.ac(3,"b",13),b.Cc(4,"Filtrar por a\xf1o "),b.Zb(),b.ac(5,"select",14),b.ic("ngModelChange",(function(t){return b.yc(e),b.kc().selectedYear=t})),b.Bc(6,J,2,2,"option",15),b.Zb(),b.Zb(),b.ac(7,"div",12),b.ac(8,"b",13),b.Cc(9,"Filtrar por mes "),b.Zb(),b.ac(10,"select",14),b.ic("ngModelChange",(function(t){return b.yc(e),b.kc().selectedMonth=t})),b.Bc(11,M,2,2,"option",15),b.Zb(),b.Zb(),b.Zb(),b.ac(12,"div"),b.ac(13,"table",16),b.ac(14,"thead",17),b.ac(15,"tr"),b.ac(16,"th"),b.Cc(17,"Fecha Reserva"),b.Zb(),b.ac(18,"th"),b.Cc(19,"Cantidad"),b.Zb(),b.ac(20,"th"),b.Cc(21,"Precio"),b.Zb(),b.ac(22,"th"),b.Cc(23,"N\xfamero Documento"),b.Zb(),b.ac(24,"th"),b.Cc(25,"Ticket Tipo"),b.Zb(),b.Zb(),b.Zb(),b.ac(26,"tbody"),b.Bc(27,D,3,0,"tr",18),b.lc(28,"reservasMes"),b.lc(29,"reservasYear"),b.Bc(30,S,13,11,"tr",19),b.lc(31,"reservasMes"),b.lc(32,"reservasYear"),b.Zb(),b.Zb(),b.Zb(),b.Zb()}if(2&e){const e=b.kc();b.Jb(5),b.rc("ngModel",e.selectedYear),b.Jb(1),b.rc("ngForOf",e.years),b.Jb(4),b.rc("ngModel",e.selectedMonth),b.Jb(1),b.rc("ngForOf",e.months),b.Jb(16),b.rc("ngIf",0===b.oc(28,6,b.oc(29,10,e.reservasTick,e.selectedYear,"ticket"),e.selectedMonth,"ticket").length),b.Jb(3),b.rc("ngForOf",b.oc(31,14,b.oc(32,18,e.reservasTick,e.selectedYear,"ticket"),e.selectedMonth,"ticket"))}}function w(e,t){if(1&e&&(b.ac(0,"div",0),b.Wb(1,"app-chart-reservas-tickets",23),b.Zb()),2&e){const e=b.kc();b.Jb(1),b.rc("reservas",e.reservasTick)}}let F=(()=>{class e{constructor(e,t){this.reservasTickService=e,this.dateService=t,this.verGrafica=!1,this.selectedMonth=(new Date).getMonth()+1,this.selectedYear=(new Date).getFullYear(),this.months=[],this.years=[]}ngOnInit(){this.months=this.dateService.meses,this.years=this.dateService.getYears(),this.prepare()}prepare(){return Object(n.a)(this,void 0,void 0,(function*(){this.reservasTick=yield this.reservasTickService.getReservasTickets()}))}generarPdft(){const e=new s;e.text(85,10,"Reporte Tickets"),o()(e,{html:"#tablat"}),e.save("Reporte_Tickets.pdf")}nameTicket(e){return 1===e?"VISITANTE":2===e?"RESIDENTE":"NI\xd1O 5-10 A\xd1OS"}}return e.\u0275fac=function(t){return new(t||e)(b.Vb(f),b.Vb(v.a))},e.\u0275cmp=b.Pb({type:e,selectors:[["app-tickets"]],decls:13,vars:4,consts:[[1,"container"],[1,"float-left"],["routerLink","/reportes",1,"btn","btn-sm","btn-light","shadow"],[1,"fas","fa-arrow-left"],[1,"text-muted","text-center","d-block"],[1,"btn","btn-sm","btn-info",3,"click"],["class","float-right",4,"ngIf"],["class","container table-responsive",4,"ngIf"],["class","container",4,"ngIf"],[1,"float-right"],[1,"container","table-responsive"],[1,"row","justify-content-end","mb-2"],[1,"col-md-3","col-sm-4","col-xs-6"],[1,"text-muted"],[1,"form-control",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["id","tablat",1,"table","table-sm","table-bordered","text-center"],[1,"thead-dark"],["class","text-center",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"value"],[1,"text-center"],["colspan","6"],[3,"reservas"]],template:function(e,t){1&e&&(b.ac(0,"div",0),b.ac(1,"div",1),b.ac(2,"button",2),b.Wb(3,"i",3),b.Zb(),b.Zb(),b.ac(4,"b",4),b.Cc(5,"REPORTES RESERVAS TICKETS"),b.Zb(),b.Zb(),b.Wb(6,"hr"),b.ac(7,"div",1),b.ac(8,"button",5),b.ic("click",(function(){return t.verGrafica=!t.verGrafica})),b.Cc(9),b.Zb(),b.Zb(),b.Bc(10,T,3,0,"div",6),b.Bc(11,I,33,22,"div",7),b.Bc(12,w,2,1,"div",8)),2&e&&(b.Jb(9),b.Ec(" ",t.verGrafica?"VER TABLA":"VER GR\xc1FICA"," "),b.Jb(1),b.rc("ngIf",!t.verGrafica),b.Jb(1),b.rc("ngIf",t.reservasTick&&!t.verGrafica),b.Jb(1),b.rc("ngIf",t.reservasTick&&t.verGrafica))},directives:[c.c,a.m,g.o,g.g,g.j,a.l,g.k,g.q,m],pipes:[y.a,Z.a,a.e,a.c],styles:[""]}),e})();var O=r("j1ZV"),R=r("iTUp");r.d(t,"TicketsModule",(function(){return Y}));let Y=(()=>{class e{}return e.\u0275mod=b.Tb({type:e}),e.\u0275inj=b.Sb({factory:function(t){return new(t||e)},imports:[[a.b,O.a,R.a,g.e,c.e.forChild([{path:"",component:F}])]]}),e})()}}]);