(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{Fv63:function(e,o,r){"use strict";r.r(o);var t=r("ofXK"),i=r("mrSG"),n=r("fXoL"),a=r("VngK"),c=r("vDOo"),s=r("tyNb"),d=r("4ZJM"),l=r("AytR"),b=r("PSD3"),u=r.n(b);const m=["mapa"];let p=(()=>{class e{constructor(e,o){this.geometryService=e,this.recorridosService=o,this.eliminado=new n.q,this.geojson={type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"LineString",coordinates:[]}}]}}ngOnInit(){}ngAfterViewInit(){d.accessToken=l.a.mapboxToken,this.mapbox=new d.Map({container:this.mapa.nativeElement,style:"mapbox://styles/mapbox/streets-v11",center:[-74.3451602,4.8154681],zoom:14.5}),this.mapbox.on("load",()=>{this.mapbox.addSource("line",{type:"geojson",data:this.geojson}),this.mapbox.addLayer({id:"line-animation",type:"line",source:"line",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#ed6498","line-width":5,"line-opacity":.8}}),this.cargarRuta(),this.cargarPtsControl(),this.cargarPtsInteres()}),this.mapbox.addControl(new d.NavigationControl),this.mapbox.addControl(new d.FullscreenControl)}cargarRuta(){const e=this.geometryService.getCoordinates(this.recorrido.RutaText);this.geojson.features[0].geometry.coordinates=e,this.mapbox.getSource("line").setData(this.geojson)}cargarPtsControl(){JSON.parse(this.recorrido.PuntosControl).forEach(e=>{const o=new d.Popup({offset:25}).setText(e.nombre);new d.Marker({color:"#d33"}).setPopup(o).setLngLat([e.longitud,e.latitud]).addTo(this.mapbox)})}cargarPtsInteres(){JSON.parse(this.recorrido.PuntosInteres).forEach(e=>{const o=new d.Popup({offset:25}).setText(e.Descripcion);(new d.Marker).setPopup(o).setLngLat([e.Longitud,e.Latitud]).addTo(this.mapbox)})}eliminar(){u.a.fire({title:"\xbfEst\xe1s seguro?",text:"No ser\xe1s capaz de revertir los cambios",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, eliminar",cancelButtonText:"Cancelar"}).then(e=>Object(i.a)(this,void 0,void 0,(function*(){e.value&&(yield this.recorridosService.eliminarRecorrido(this.recorrido.Id))&&(u.a.fire("Eliminado!","success"),this.eliminado.emit(this.recorrido.Id))})))}}return e.\u0275fac=function(o){return new(o||e)(n.Tb(c.a),n.Tb(a.a))},e.\u0275cmp=n.Nb({type:e,selectors:[["app-card-recorrido"]],viewQuery:function(e,o){var r;1&e&&n.Dc(m,!0),2&e&&n.sc(r=n.hc())&&(o.mapa=r.first)},inputs:{recorrido:"recorrido"},outputs:{eliminado:"eliminado"},decls:13,vars:2,consts:[[1,"card","shadow"],[1,"card-header"],[1,"text-muted"],[1,"float-right"],[1,"btn","btn-sm","btn-outline-danger",3,"click"],[1,"fas","fa-trash"],[1,"card-body"],["id","map"],["mapa",""]],template:function(e,o){1&e&&(n.Yb(0,"div",0),n.Yb(1,"div",1),n.Yb(2,"b",2),n.zc(3),n.Xb(),n.Ub(4,"br"),n.Yb(5,"small"),n.zc(6),n.Xb(),n.Yb(7,"div",3),n.Yb(8,"div",4),n.gc("click",(function(){return o.eliminar()})),n.Ub(9,"i",5),n.Xb(),n.Xb(),n.Xb(),n.Yb(10,"div",6),n.Ub(11,"div",7,8),n.Xb(),n.Xb()),2&e&&(n.Hb(3),n.Ac(o.recorrido.Nombre),n.Hb(3),n.Bc("",o.recorrido.TiempoEstimado," minutos aprox."))},styles:["#map[_ngcontent-%COMP%]{width:100%;height:250px}"]}),e})();function h(e,o){1&e&&(n.Yb(0,"div",8),n.Yb(1,"h5",9),n.zc(2,"No hay rutas para mostrar"),n.Xb(),n.Xb())}function g(e,o){if(1&e){const e=n.Zb();n.Yb(0,"app-card-recorrido",10),n.gc("eliminado",(function(o){return n.uc(e),n.ic().eliminar(o)})),n.Xb()}2&e&&n.mc("recorrido",o.$implicit)}let f=(()=>{class e{constructor(e,o){this.recorridosService=e,this.geometryService=o,this.recorridos=[]}ngOnInit(){this.cargarRecorridos()}cargarRecorridos(){return Object(i.a)(this,void 0,void 0,(function*(){this.recorridos=yield this.recorridosService.getRecorridos()}))}eliminar(e){this.recorridos=this.recorridos.filter(o=>o.Id!==e)}}return e.\u0275fac=function(o){return new(o||e)(n.Tb(a.a),n.Tb(c.a))},e.\u0275cmp=n.Nb({type:e,selectors:[["app-inicio"]],decls:12,vars:2,consts:[[1,"container","p-2"],["routerLink","/recorridos/nuevo",1,"btn","btn-sm","btn-success"],[1,"float-right"],[1,"badge","badge-primary","mr-2"],[1,"badge","badge-danger"],["class","container",4,"ngIf"],[1,"row"],["class","col-md-4 col-sm-6 mb-2",3,"recorrido","eliminado",4,"ngFor","ngForOf"],[1,"container"],[1,"text-muted"],[1,"col-md-4","col-sm-6","mb-2",3,"recorrido","eliminado"]],template:function(e,o){1&e&&(n.Yb(0,"div",0),n.Yb(1,"button",1),n.zc(2,"Nueva ruta"),n.Xb(),n.Yb(3,"div",2),n.Yb(4,"span",3),n.zc(5,"Punto de inter\xe9s"),n.Xb(),n.Yb(6,"span",4),n.zc(7,"Punto de control"),n.Xb(),n.Xb(),n.Xb(),n.Ub(8,"hr"),n.xc(9,h,3,0,"div",5),n.Yb(10,"div",6),n.xc(11,g,1,1,"app-card-recorrido",7),n.Xb()),2&e&&(n.Hb(9),n.mc("ngIf",0===o.recorridos.length),n.Hb(2),n.mc("ngForOf",o.recorridos))},directives:[s.c,t.k,t.j,p],styles:[""]}),e})();var v=r("j1ZV"),y=r("3Pt+");r.d(o,"InicioModule",(function(){return w}));let w=(()=>{class e{}return e.\u0275mod=n.Rb({type:e}),e.\u0275inj=n.Qb({factory:function(o){return new(o||e)},imports:[[t.b,v.a,y.e,s.e.forChild([{path:"",component:f}])]]}),e})()}}]);