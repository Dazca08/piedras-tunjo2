(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{HnS2:function(e,t,r){"use strict";r.r(t);var c=r("ofXK"),a=r("tyNb"),s=r("mrSG"),n=r("5RHE"),i=r("DaQG"),o=r.n(i),b=r("fXoL"),l=r("tk/3"),h=r("AytR"),d=r("JIr8"),p=r("LRne"),u=r("Ig2y");const v=h.a.apiUrl;let f=(()=>{class e{constructor(e,t,r){this.http=e,this.router=t,this.dateService=r}prepareHeaders(){const e=localStorage.getItem("token")||void 0;return e?(this.headers=new l.c({Authorization:"Bearer "+e}),!0):(this.router.navigateByUrl("/login"),!1)}getReservasTickets(){return this.prepareHeaders()?new Promise(e=>{this.http.get(`${v}/reserva-tickets`,{headers:this.headers}).pipe(Object(d.a)(e=>Object(p.a)({ok:!1}))).subscribe(t=>{e(!0===t.ok?t.reservas:[])})}):(console.log("Token not found"),Promise.resolve([]))}getDataChart(e){const t=[],r=this.dateService.meses,c=(new Date).getFullYear();return r.forEach((r,a)=>{t.push(this.getTicketsByMonth(e,a+1,c))}),console.log(t),t}getTicketsByMonth(e,t,r){const c=[];return e.forEach(e=>{const a=e.FechaIngreso.toString().split("T")[0],s=Number(a.split("-")[0]),n=Number(a.split("-")[1]);s===r&&n===t&&c.push(e)}),c.length}}return e.\u0275fac=function(t){return new(t||e)(b.ec(l.a),b.ec(a.b),b.ec(u.a))},e.\u0275prov=b.Rb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var g=r("3Pt+"),k=r("LPYB");let m=(()=>{class e{constructor(e){this.reservaTickService=e,this.typeChart="line",this.barChartOptions={responsive:!0,scales:{xAxes:[{}],yAxes:[{}]},plugins:{datalabels:{anchor:"end",align:"end"}}},this.barChartLabels=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre",""],this.barChartType="line",this.barChartLegend=!0,this.barChartData=[{data:[65,59,80,81,56,55,40,50,40,40,60,40,0],label:"Meses"}]}ngOnInit(){this.prepareData()}prepareData(){const e=this.reservaTickService.getDataChart(this.reservas);this.barChartData[0].data=e}chartClicked({event:e,active:t}){console.log(e,t)}chartHovered({event:e,active:t}){console.log(e,t)}}return e.\u0275fac=function(t){return new(t||e)(b.Vb(f))},e.\u0275cmp=b.Pb({type:e,selectors:[["app-chart-reservas-tickets"]],inputs:{reservas:"reservas"},decls:9,vars:7,consts:[[1,"container","text-center"],["role","group",1,"btn-group"],[1,"btn","btn-sm",3,"ngClass","click"],[1,"fas","fa-chart-area"],[1,"fas","fa-chart-bar"],[1,"row","justify-content-center","mt-5"],[1,"col-md-10"],["baseChart","",3,"datasets","labels","options","legend","chartType"]],template:function(e,t){1&e&&(b.ac(0,"div",0),b.ac(1,"div",1),b.ac(2,"button",2),b.ic("click",(function(){return t.typeChart="line"})),b.Wb(3,"i",3),b.Zb(),b.ac(4,"button",2),b.ic("click",(function(){return t.typeChart="bar"})),b.Wb(5,"i",4),b.Zb(),b.Zb(),b.Zb(),b.ac(6,"div",5),b.ac(7,"div",6),b.Wb(8,"canvas",7),b.Zb(),b.Zb()),2&e&&(b.Jb(2),b.rc("ngClass","line"===t.typeChart?"btn-primary":"btn-outline-primary"),b.Jb(2),b.rc("ngClass","bar"===t.typeChart?"btn-primary":"btn-outline-primary"),b.Jb(4),b.rc("datasets",t.barChartData)("labels",t.barChartLabels)("options",t.barChartOptions)("legend",t.barChartLegend)("chartType",t.typeChart))},directives:[c.k,k.a],styles:[""]}),e})();var C=r("mEn6");function Z(e,t){if(1&e&&(b.ac(0,"option",20),b.Cc(1),b.Zb()),2&e){const e=t.index,r=b.kc(2);b.rc("value",(e+1).toString()),b.Jb(1),b.Dc(r.months[e])}}function y(e,t){1&e&&(b.ac(0,"tr",21),b.ac(1,"td",22),b.Cc(2,"No hay reservas para mostrar en el mes seleccionado"),b.Zb(),b.Zb())}function T(e,t){if(1&e&&(b.ac(0,"tr"),b.ac(1,"td"),b.Cc(2),b.lc(3,"date"),b.Zb(),b.ac(4,"td"),b.Cc(5),b.Zb(),b.ac(6,"td"),b.Cc(7),b.lc(8,"currency"),b.Zb(),b.ac(9,"td"),b.Cc(10),b.Zb(),b.ac(11,"td"),b.Cc(12),b.Zb(),b.ac(13,"td"),b.Cc(14),b.Zb(),b.Zb()),2&e){const e=t.$implicit;b.Jb(2),b.Dc(b.nc(3,6,e.FechaIngreso,"dd MMM yyyy")),b.Jb(3),b.Dc(e.Cantidad),b.Jb(2),b.Dc(b.nc(8,9,e.Precio,"COP ")),b.Jb(3),b.Dc(e.UUsuarioId),b.Jb(2),b.Dc(e.NumeroDocumento),b.Jb(2),b.Dc(e.idTicket)}}function J(e,t){if(1&e){const e=b.bc();b.ac(0,"div",9),b.ac(1,"div",10),b.ac(2,"div",11),b.ac(3,"b",12),b.Cc(4,"Filtrar por mes "),b.Zb(),b.ac(5,"select",13),b.ic("ngModelChange",(function(t){return b.yc(e),b.kc().selectedMonth=t})),b.Bc(6,Z,2,2,"option",14),b.Zb(),b.Zb(),b.Zb(),b.ac(7,"div",15),b.ac(8,"table",16),b.ac(9,"thead",17),b.ac(10,"tr"),b.ac(11,"th"),b.Cc(12,"Fecha Reserva"),b.Zb(),b.ac(13,"th"),b.Cc(14,"Cantidad"),b.Zb(),b.ac(15,"th"),b.Cc(16,"Precio"),b.Zb(),b.ac(17,"th"),b.Cc(18,"Usuario"),b.Zb(),b.ac(19,"th"),b.Cc(20,"N\xfamero Documento"),b.Zb(),b.ac(21,"th"),b.Cc(22,"Ticket Tipo"),b.Zb(),b.Zb(),b.Zb(),b.ac(23,"tbody"),b.Bc(24,y,3,0,"tr",18),b.lc(25,"reservasMes"),b.Bc(26,T,15,12,"tr",19),b.lc(27,"reservasMes"),b.Zb(),b.Zb(),b.Zb(),b.Zb()}if(2&e){const e=b.kc();b.Jb(5),b.rc("ngModel",e.selectedMonth),b.Jb(1),b.rc("ngForOf",e.months),b.Jb(18),b.rc("ngIf",0===b.oc(25,4,e.reservasTick,e.selectedMonth,"ticket").length),b.Jb(2),b.rc("ngForOf",b.oc(27,8,e.reservasTick,e.selectedMonth,"ticket"))}}function M(e,t){if(1&e&&(b.ac(0,"div",0),b.Wb(1,"app-chart-reservas-tickets",23),b.Zb()),2&e){const e=b.kc();b.Jb(1),b.rc("reservas",e.reservasTick)}}let D=(()=>{class e{constructor(e){this.reservasTickService=e,this.verGrafica=!1,this.selectedMonth=((new Date).getMonth()+1).toString(),this.months=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"]}ngOnInit(){this.prepare()}prepare(){return Object(s.a)(this,void 0,void 0,(function*(){this.reservasTick=yield this.reservasTickService.getReservasTickets(),console.log(this.reservasTick)}))}generarPdft(){const e=new n;e.text(85,10,"Reporte Tickets"),o()(e,{html:"#tablat"}),e.save("Reporte_Tickets.pdf")}}return e.\u0275fac=function(t){return new(t||e)(b.Vb(f))},e.\u0275cmp=b.Pb({type:e,selectors:[["app-tickets"]],decls:15,vars:3,consts:[[1,"container"],[1,"float-left"],["routerLink","/reportes",1,"btn","btn-sm","btn-light","shadow"],[1,"fas","fa-arrow-left"],[1,"text-muted","text-center","d-block"],[1,"btn","btn-sm","btn-info",3,"click"],[1,"float-right"],["class"," table-responsive",4,"ngIf"],["class","container",4,"ngIf"],[1,"table-responsive"],[1,"row","justify-content-end","mb-2"],[1,"col-md-3","col-sm-4","col-xs-6"],[1,"text-muted"],[1,"form-control",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["id","ticketreporte",1,"table-responsive-sm"],["id","tablat",1,"table","table-sm","table-bordered"],[1,"thead-dark"],["class","text-center",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"value"],[1,"text-center"],["colspan","6"],[3,"reservas"]],template:function(e,t){1&e&&(b.ac(0,"div",0),b.ac(1,"div",1),b.ac(2,"button",2),b.Wb(3,"i",3),b.Zb(),b.Zb(),b.ac(4,"b",4),b.Cc(5,"REPORTES RESERVAS TICKETS"),b.Zb(),b.Zb(),b.Wb(6,"hr"),b.ac(7,"div",1),b.ac(8,"button",5),b.ic("click",(function(){return t.verGrafica=!t.verGrafica})),b.Cc(9),b.Zb(),b.Zb(),b.ac(10,"div",6),b.ac(11,"button",5),b.ic("click",(function(){return t.generarPdft()})),b.Cc(12," Generar Reporte "),b.Zb(),b.Zb(),b.Bc(13,J,28,12,"div",7),b.Bc(14,M,2,1,"div",8)),2&e&&(b.Jb(9),b.Ec(" ",t.verGrafica?"VER TABLA":"VER GR\xc1FICA"," "),b.Jb(4),b.rc("ngIf",t.reservasTick&&!t.verGrafica),b.Jb(1),b.rc("ngIf",t.reservasTick&&t.verGrafica))},directives:[a.c,c.m,g.o,g.g,g.j,c.l,g.k,g.q,m],pipes:[C.a,c.e,c.c],styles:[""]}),e})();var w=r("j1ZV"),S=r("iTUp");r.d(t,"TicketsModule",(function(){return I}));let I=(()=>{class e{}return e.\u0275mod=b.Tb({type:e}),e.\u0275inj=b.Sb({factory:function(t){return new(t||e)},imports:[[c.b,w.a,S.a,g.e,a.e.forChild([{path:"",component:D}])]]}),e})()}}]);