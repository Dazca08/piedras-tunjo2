function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{HnS2:function(e,t,r){"use strict";r.r(t);var a,c=r("ofXK"),n=r("tyNb"),i=r("mrSG"),s=r("5RHE"),o=r("DaQG"),l=r.n(o),b=r("fXoL"),u=r("tk/3"),h=r("AytR"),v=r("JIr8"),f=r("LRne"),d=r("Ig2y"),p=h.a.apiUrl,g=((a=function(){function e(t,r,a){_classCallCheck(this,e),this.http=t,this.router=r,this.dateService=a}return _createClass(e,[{key:"prepareHeaders",value:function(){var e=localStorage.getItem("token")||void 0;return e?(this.headers=new u.c({Authorization:"Bearer "+e}),!0):(this.router.navigateByUrl("/login"),!1)}},{key:"getReservasTickets",value:function(){var e=this;return this.prepareHeaders()?new Promise((function(t){e.http.get("".concat(p,"/reserva-tickets"),{headers:e.headers}).pipe(Object(v.a)((function(e){return Object(f.a)({ok:!1})}))).subscribe((function(e){t(!0===e.ok?e.reservas:[])}))})):(console.log("Token not found"),Promise.resolve([]))}},{key:"getDataChart",value:function(e,t){var r=this,a=[];return this.dateService.meses.forEach((function(c,n){a.push(r.getTicketsByMonthYear(e,n+1,Number(t)))})),a}},{key:"getTicketsByMonthYear",value:function(e,t,r){var a=[];return e.forEach((function(e){var c=e.FechaIngreso.toString().split("T")[0],n=Number(c.split("-")[0]),i=Number(c.split("-")[1]);n===r&&i===t&&a.push(e)})),a.length}}]),e}()).\u0275fac=function(e){return new(e||a)(b.ec(u.a),b.ec(n.b),b.ec(d.a))},a.\u0275prov=b.Rb({token:a,factory:a.\u0275fac,providedIn:"root"}),a),k=r("3Pt+"),C=r("LPYB");function y(e,t){if(1&e&&(b.ac(0,"option",12),b.Cc(1),b.Zb()),2&e){var r=t.index,a=b.kc();b.rc("value",a.years[r]),b.Jb(1),b.Dc(a.years[r])}}var m,Z=((m=function(){function e(t,r){_classCallCheck(this,e),this.reservaTickService=t,this.dateService=r,this.selectedYear=(new Date).getFullYear(),this.years=[],this.typeChart="line",this.barChartOptions={responsive:!0,scales:{xAxes:[{}],yAxes:[{}]},plugins:{datalabels:{anchor:"end",align:"end"}}},this.barChartLabels=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre",""],this.barChartType="line",this.barChartLegend=!0,this.barChartData=[{data:[65,59,80,81,56,55,40,50,40,40,60,40,0],label:"Meses"}]}return _createClass(e,[{key:"ngOnInit",value:function(){this.years=this.dateService.getYears(),this.prepareData()}},{key:"prepareData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(new Date).getFullYear(),t=this.reservaTickService.getDataChart(this.reservas,e);this.barChartData[0].data=t}},{key:"onChange",value:function(e){this.prepareData(e.target.value)}},{key:"chartClicked",value:function(e){var t=e.event,r=e.active;console.log(t,r)}},{key:"chartHovered",value:function(e){var t=e.event,r=e.active;console.log(t,r)}}]),e}()).\u0275fac=function(e){return new(e||m)(b.Vb(g),b.Vb(d.a))},m.\u0275cmp=b.Pb({type:m,selectors:[["app-chart-reservas-tickets"]],inputs:{reservas:"reservas"},decls:14,vars:9,consts:[[1,"container","text-center"],["role","group",1,"btn-group"],[1,"btn","btn-sm",3,"ngClass","click"],[1,"fas","fa-chart-area"],[1,"fas","fa-chart-bar"],[1,"float-right"],[1,"text-muted"],[1,"form-control-sm",3,"ngModel","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],[1,"row","justify-content-center","mt-5"],[1,"col-10"],["baseChart","",3,"datasets","labels","options","legend","chartType"],[3,"value"]],template:function(e,t){1&e&&(b.ac(0,"div",0),b.ac(1,"div",1),b.ac(2,"button",2),b.ic("click",(function(){return t.typeChart="line"})),b.Wb(3,"i",3),b.Zb(),b.ac(4,"button",2),b.ic("click",(function(){return t.typeChart="bar"})),b.Wb(5,"i",4),b.Zb(),b.Zb(),b.Zb(),b.ac(6,"div",5),b.ac(7,"b",6),b.Cc(8,"Filtrar por a\xf1o "),b.Zb(),b.ac(9,"select",7),b.ic("ngModelChange",(function(e){return t.selectedYear=e}))("change",(function(e){return t.onChange(e)})),b.Bc(10,y,2,2,"option",8),b.Zb(),b.Zb(),b.ac(11,"div",9),b.ac(12,"div",10),b.Wb(13,"canvas",11),b.Zb(),b.Zb()),2&e&&(b.Jb(2),b.rc("ngClass","line"===t.typeChart?"btn-primary":"btn-outline-primary"),b.Jb(2),b.rc("ngClass","bar"===t.typeChart?"btn-primary":"btn-outline-primary"),b.Jb(5),b.rc("ngModel",t.selectedYear),b.Jb(1),b.rc("ngForOf",t.years),b.Jb(3),b.rc("datasets",t.barChartData)("labels",t.barChartLabels)("options",t.barChartOptions)("legend",t.barChartLegend)("chartType",t.typeChart))},directives:[c.k,k.o,k.g,k.j,c.l,C.a,k.k,k.q],styles:[""]}),m),T=r("mEn6"),J=r("OLLB");function M(e,t){if(1&e){var r=b.bc();b.ac(0,"div",9),b.ac(1,"button",5),b.ic("click",(function(){return b.yc(r),b.kc().generarPdft()})),b.Cc(2," Generar Reporte "),b.Zb(),b.Zb()}}function w(e,t){if(1&e&&(b.ac(0,"option",20),b.Cc(1),b.Zb()),2&e){var r=t.index,a=b.kc(2);b.rc("value",a.years[r]),b.Jb(1),b.Dc(a.years[r])}}function D(e,t){if(1&e&&(b.ac(0,"option",20),b.Cc(1),b.Zb()),2&e){var r=t.index,a=b.kc(2);b.rc("value",r+1),b.Jb(1),b.Dc(a.months[r])}}function S(e,t){1&e&&(b.ac(0,"tr",21),b.ac(1,"td",22),b.Cc(2,"No hay reservas para mostrar en el mes seleccionado"),b.Zb(),b.Zb())}function I(e,t){if(1&e&&(b.ac(0,"tr"),b.ac(1,"td"),b.Cc(2),b.lc(3,"date"),b.Zb(),b.ac(4,"td"),b.Cc(5),b.Zb(),b.ac(6,"td"),b.Cc(7),b.lc(8,"currency"),b.Zb(),b.ac(9,"td"),b.Cc(10),b.Zb(),b.ac(11,"td"),b.Cc(12),b.Zb(),b.Zb()),2&e){var r=t.$implicit,a=b.kc(2);b.Jb(2),b.Dc(b.nc(3,5,r.FechaIngreso,"dd MMM yyyy")),b.Jb(3),b.Dc(r.Cantidad),b.Jb(2),b.Dc(b.nc(8,8,r.Precio,"COP ")),b.Jb(3),b.Dc(r.NumeroDocumento),b.Jb(2),b.Dc(a.nameTicket(r.idTicket))}}function F(e,t){if(1&e){var r=b.bc();b.ac(0,"div",10),b.ac(1,"div",11),b.ac(2,"div",12),b.ac(3,"b",13),b.Cc(4,"Filtrar por a\xf1o "),b.Zb(),b.ac(5,"select",14),b.ic("ngModelChange",(function(e){return b.yc(r),b.kc().selectedYear=e})),b.Bc(6,w,2,2,"option",15),b.Zb(),b.Zb(),b.ac(7,"div",12),b.ac(8,"b",13),b.Cc(9,"Filtrar por mes "),b.Zb(),b.ac(10,"select",14),b.ic("ngModelChange",(function(e){return b.yc(r),b.kc().selectedMonth=e})),b.Bc(11,D,2,2,"option",15),b.Zb(),b.Zb(),b.Zb(),b.ac(12,"div"),b.ac(13,"table",16),b.ac(14,"thead",17),b.ac(15,"tr"),b.ac(16,"th"),b.Cc(17,"Fecha Reserva"),b.Zb(),b.ac(18,"th"),b.Cc(19,"Cantidad"),b.Zb(),b.ac(20,"th"),b.Cc(21,"Precio"),b.Zb(),b.ac(22,"th"),b.Cc(23,"N\xfamero Documento"),b.Zb(),b.ac(24,"th"),b.Cc(25,"Ticket Tipo"),b.Zb(),b.Zb(),b.Zb(),b.ac(26,"tbody"),b.Bc(27,S,3,0,"tr",18),b.lc(28,"reservasMes"),b.lc(29,"reservasYear"),b.Bc(30,I,13,11,"tr",19),b.lc(31,"reservasMes"),b.lc(32,"reservasYear"),b.Zb(),b.Zb(),b.Zb(),b.Zb()}if(2&e){var a=b.kc();b.Jb(5),b.rc("ngModel",a.selectedYear),b.Jb(1),b.rc("ngForOf",a.years),b.Jb(4),b.rc("ngModel",a.selectedMonth),b.Jb(1),b.rc("ngForOf",a.months),b.Jb(16),b.rc("ngIf",0===b.oc(28,6,b.oc(29,10,a.reservasTick,a.selectedYear,"ticket"),a.selectedMonth,"ticket").length),b.Jb(3),b.rc("ngForOf",b.oc(31,14,b.oc(32,18,a.reservasTick,a.selectedYear,"ticket"),a.selectedMonth,"ticket"))}}function O(e,t){if(1&e&&(b.ac(0,"div",0),b.Wb(1,"app-chart-reservas-tickets",23),b.Zb()),2&e){var r=b.kc();b.Jb(1),b.rc("reservas",r.reservasTick)}}var R,x=((R=function(){function e(t,r){_classCallCheck(this,e),this.reservasTickService=t,this.dateService=r,this.verGrafica=!1,this.selectedMonth=(new Date).getMonth()+1,this.selectedYear=(new Date).getFullYear(),this.months=[],this.years=[]}return _createClass(e,[{key:"ngOnInit",value:function(){this.months=this.dateService.meses,this.years=this.dateService.getYears(),this.prepare()}},{key:"prepare",value:function(){return Object(i.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.reservasTickService.getReservasTickets();case 2:this.reservasTick=e.sent;case 3:case"end":return e.stop()}}),e,this)})))}},{key:"generarPdft",value:function(){var e=new s;e.text(85,10,"Reporte Tickets"),l()(e,{html:"#tablat"}),e.save("Reporte_Tickets.pdf")}},{key:"nameTicket",value:function(e){return 1===e?"VISITANTE":2===e?"RESIDENTE":"NI\xd1O 5-10 A\xd1OS"}}]),e}()).\u0275fac=function(e){return new(e||R)(b.Vb(g),b.Vb(d.a))},R.\u0275cmp=b.Pb({type:R,selectors:[["app-tickets"]],decls:13,vars:4,consts:[[1,"container"],[1,"float-left"],["routerLink","/reportes",1,"btn","btn-sm","btn-light","shadow"],[1,"fas","fa-arrow-left"],[1,"text-muted","text-center","d-block"],[1,"btn","btn-sm","btn-info",3,"click"],["class","float-right",4,"ngIf"],["class","container table-responsive",4,"ngIf"],["class","container",4,"ngIf"],[1,"float-right"],[1,"container","table-responsive"],[1,"row","justify-content-end","mb-2"],[1,"col-md-3","col-sm-4","col-xs-6"],[1,"text-muted"],[1,"form-control",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["id","tablat",1,"table","table-sm","table-bordered","text-center"],[1,"thead-dark"],["class","text-center",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"value"],[1,"text-center"],["colspan","6"],[3,"reservas"]],template:function(e,t){1&e&&(b.ac(0,"div",0),b.ac(1,"div",1),b.ac(2,"button",2),b.Wb(3,"i",3),b.Zb(),b.Zb(),b.ac(4,"b",4),b.Cc(5,"REPORTES RESERVAS TICKETS"),b.Zb(),b.Zb(),b.Wb(6,"hr"),b.ac(7,"div",1),b.ac(8,"button",5),b.ic("click",(function(){return t.verGrafica=!t.verGrafica})),b.Cc(9),b.Zb(),b.Zb(),b.Bc(10,M,3,0,"div",6),b.Bc(11,F,33,22,"div",7),b.Bc(12,O,2,1,"div",8)),2&e&&(b.Jb(9),b.Ec(" ",t.verGrafica?"VER TABLA":"VER GR\xc1FICA"," "),b.Jb(1),b.rc("ngIf",!t.verGrafica),b.Jb(1),b.rc("ngIf",t.reservasTick&&!t.verGrafica),b.Jb(1),b.rc("ngIf",t.reservasTick&&t.verGrafica))},directives:[n.c,c.m,k.o,k.g,k.j,c.l,k.k,k.q,Z],pipes:[T.a,J.a,c.e,c.c],styles:[""]}),R),E=r("j1ZV"),Y=r("iTUp");r.d(t,"TicketsModule",(function(){return B}));var P,B=((P=function e(){_classCallCheck(this,e)}).\u0275mod=b.Tb({type:P}),P.\u0275inj=b.Sb({factory:function(e){return new(e||P)},imports:[[c.b,E.a,Y.a,k.e,n.e.forChild([{path:"",component:x}])]]}),P)}}]);